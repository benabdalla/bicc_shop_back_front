<div class="page-wrapper">
  <div class="page-content">
    <div class="card">
      <div class="row g-0">
        <div class="col-md-4 border-end">
          <!-- Main Image Display -->
          <div class="position-relative main-image-container">
            <img
              src="{{ host + getCurrentImage() }}"
              class="img-fluid main-product-image"
              [alt]="product.title"
            />

            <!-- Navigation arrows for multiple images -->
            <div *ngIf="hasMultipleImages()" class="image-navigation">
              <button
                class="btn btn-light btn-sm nav-btn nav-prev"
                (click)="previousImage()"
                title="Image précédente"
              >
                <i class="bx bx-chevron-left"></i>
              </button>
              <button
                class="btn btn-light btn-sm nav-btn nav-next"
                (click)="nextImage()"
                title="Image suivante"
              >
                <i class="bx bx-chevron-right"></i>
              </button>
            </div>

            <!-- Image counter -->
            <div *ngIf="hasMultipleImages()" class="image-counter">
              {{ currentImageIndex + 1 }} / {{ getAllImages().length }}
            </div>
          </div>

          <!-- Thumbnail Gallery -->
          <div
            class="row mb-3 row-cols-auto g-2 justify-content-center mt-3 thumbnail-gallery"
            *ngIf="getAllImages().length > 0"
          >
            <div
              class="col"
              *ngFor="let image of getAllImages(); let i = index"
            >
              <img
                src="{{ host + image }}"
                width="70"
                class="border rounded cursor-pointer thumbnail-image"
                [class.active]="i === currentImageIndex"
                (click)="setCurrentImage(i)"
                [alt]="'Product thumbnail ' + (i + 1)"
              />
            </div>
          </div>
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <h2
              class="float-end text-danger cursor-pointer"
              (click)="toggleWishlist()"
            >
              <i
                class="bx"
                [class]="isWishlisted ? 'bxs-heart' : 'bx-heart'"
              ></i>
            </h2>
            <h4 class="card-title">{{ product.title }}</h4>
            <div class="d-flex gap-3 py-3">
              <div class="cursor-pointer">
                <i
                  class="bx bxs-star {{
                    avgStar >= 20 ? 'text-warning' : 'text-secondary'
                  }}"
                ></i>
                <i
                  class="bx bxs-star {{
                    avgStar >= 40 ? 'text-warning' : 'text-secondary'
                  }}"
                ></i>
                <i
                  class="bx bxs-star {{
                    avgStar >= 60 ? 'text-warning' : 'text-secondary'
                  }}"
                ></i>
                <i
                  class="bx bxs-star {{
                    avgStar >= 80 ? 'text-warning' : 'text-secondary'
                  }}"
                ></i>
                <i
                  class="bx bxs-star {{
                    avgStar >= 100 ? 'text-warning' : 'text-secondary'
                  }}"
                ></i>
              </div>
              <div>{{ reviews.length }} avis</div>
              <!--<div class="text-success">
                <i class="bx bxs-cart-alt align-middle"></i> 134 orders
              </div>-->
            </div>
            <div class="mb-3">
              <span class="price h4">{{ product.salePrice }} TND</span>
              <!-- <span class="text-muted">/per kg</span> -->
              <span class="me-2 text-decoration-line-through text-secondary"
                >{{ product.regularPrice }} TND
              </span>
            </div>
            <!--<p class="card-text fs-6">
              Virgil Abloh’s Off-White is a streetwear-inspired collection that
              continues to break away from the conventions of mainstream
              fashion. Made in Italy, these black and brown Odsy-1000 low-top
              sneakers.
            </p>-->
            <dl class="row">
              <!--<dt class="col-sm-3">Model#</dt>
              <dd class="col-sm-9">Odsy-1000</dd>-->

              <dt class="col-sm-3">Catégorie</dt>
              <dd class="col-sm-9">{{ product.category }}</dd>

              <dt class="col-sm-3">Nom du magasin</dt>
              <dd class="col-sm-9">{{ product.storeName }}</dd>
            </dl>
            <hr />
            <div
              class="row row-cols-auto row-cols-1 row-cols-md-3 align-items-center"
            >
              <div class="col">
                <label class="form-label">Quantité</label>
                <div class="input-group input-spinner">
                  <button
                    (click)="quantityChange(false)"
                    class="btn btn-white"
                    type="button"
                    id="button-plus"
                  >
                    +
                  </button>
                  <input
                    disabled
                    type="number"
                    class="form-control"
                    name="quantity"
                    [(ngModel)]="quantity"
                  />
                  <button
                    (click)="quantityChange(true)"
                    class="btn btn-white"
                    type="button"
                    id="button-minus"
                  >
                    −
                  </button>
                </div>
              </div>
              <!-- <div class="col">
                                <label class="form-label">Select size</label>
                                <div class="">
                                    <label class="form-check form-check-inline">
                                        <input type="radio" class="form-check-input" name="select_size" checked=""
                                            class="custom-control-input">
                                        <div class="form-check-label">Small</div>
                                    </label>
                                    <label class="form-check form-check-inline">
                                        <input type="radio" class="form-check-input" name="select_size" checked=""
                                            class="custom-control-input">
                                        <div class="form-check-label">Medium</div>
                                    </label>

                                    <label class="form-check form-check-inline">
                                        <input type="radio" class="form-check-input" name="select_size" checked=""
                                            class="custom-control-input">
                                        <div class="form-check-label">Large</div>
                                    </label>
                                </div>
                            </div>
                            <div class="col">
                                <label class="form-label">Select Color</label>
                                <div class="color-indigators d-flex align-items-center gap-2">
                                    <div class="color-indigator-item bg-primary"></div>
                                    <div class="color-indigator-item bg-danger"></div>
                                    <div class="color-indigator-item bg-success"></div>
                                    <div class="color-indigator-item bg-warning"></div>
                                </div>
                            </div> -->
            </div>
            <div class="d-flex gap-3 mt-3">
              <button (click)="buyNow()" class="btn btn-primary">
                Acheter maintenant
              </button>
              <button (click)="addToCart()" class="btn btn-outline-primary">
                <span class="text">Ajouter au panier</span>
                <i class="bx bxs-cart-alt"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      <hr />
      <div class="card-body">
        <ul class="nav nav-tabs nav-primary mb-0" role="tablist">
          <li class="nav-item" role="presentation">
            <a
              class="nav-link active"
              data-bs-toggle="tab"
              href="#primaryhome"
              role="tab"
              aria-selected="true"
            >
              <div class="d-flex align-items-center">
                <div class="tab-icon">
                  <i class="bx bx-comment-detail font-18 me-1"></i>
                </div>
                <div class="tab-title">Description du produit</div>
              </div>
            </a>
          </li>
          <li class="nav-item" role="presentation">
            <a
              class="nav-link"
              data-bs-toggle="tab"
              href="#primaryprofile"
              role="tab"
              aria-selected="false"
            >
              <div class="d-flex align-items-center">
                <div class="tab-icon">
                  <i class="bx bx-bookmark-alt font-18 me-1"></i>
                </div>
                <div class="tab-title">Tags</div>
              </div>
            </a>
          </li>
          <li class="nav-item" role="presentation">
            <a
              class="nav-link"
              data-bs-toggle="tab"
              href="#primarycontact"
              role="tab"
              aria-selected="false"
            >
              <div class="d-flex align-items-center">
                <div class="tab-icon">
                  <i class="bx bx-star font-18 me-1"></i>
                </div>
                <div class="tab-title">Avis</div>
              </div>
            </a>
          </li>
        </ul>
        <div class="tab-content pt-3">
          <div
            class="tab-pane fade show active"
            id="primaryhome"
            role="tabpanel"
          >
            <!--<p>
              Raw denim you probably haven't heard of them jean shorts Austin.
              Nesciunt tofu stumptown aliqua, retro synth master cleanse.
              Mustache cliche tempor, williamsburg carles vegan helvetica.
              Reprehenderit butcher retro keffiyeh dreamcatcher synth. Cosby
              sweater eu banh mi, qui irure terry richardson ex squid. Aliquip
              placeat salvia cillum iphone. Seitan aliquip quis cardigan
              american apparel, butcher voluptate nisi.
            </p>
            <p>
              Jean brut, vous n'en avez probablement jamais entendu parler,
              shorts en jean Austin. Nesciunt tofu stumptown aliqua, master
              cleanse rétro synth. Moustache cliché tempor, williamsburg carles
              vegan helvetica. Reprehenderit butcher rétro keffiyeh dreamcatcher
              synth. Cosby sweater eu banh mi, qui irure terry richardson ex
              squid. Aliquip placeat salvia cillum iphone. Seitan aliquip quis
              cardigan american apparel, butcher voluptate nisi.
            </p>
            <p>
              Jean brut, vous n'en avez probablement jamais entendu parler,
              shorts en jean Austin. Nesciunt tofu stumptown aliqua, master
              cleanse rétro synth. Moustache cliché tempor, williamsburg carles
              vegan helvetica. Reprehenderit butcher rétro keffiyeh dreamcatcher
              synth. Cosby sweater eu banh mi, qui irure terry richardson ex
              squid. Aliquip placeat salvia cillum iphone. Seitan aliquip quis
              cardigan american apparel, butcher voluptate nisi.
            </p>
          </div>
          <div class="tab-pane fade" id="primaryprofile" role="tabpanel">
            <p>
              Food truck fixie locavore, accusamus mcsweeney's marfa nulla
              single-origin coffee squid. Exercitation +1 labore velit, blog
              sartorial PBR leggings next level wes anderson artisan four loko
              farm-to-table craft beer twee. Qui photo booth letterpress,
              commodo enim craft beer mlkshk aliquip jean shorts ullamco ad
              vinyl cillum PBR. Homo nostrud organic, assumenda labore aesthetic
              magna delectus mollit. Keytar helvetica VHS salvia yr, vero magna
              velit sapiente labore stumptown. Vegan fanny pack odio cillum wes
              anderson 8-bit, sustainable jean shorts beard ut DIY ethical culpa
              terry richardson biodiesel. Art party scenester stumptown, tumblr
              butcher vero sint qui sapiente accusamus tattooed echo park.
            </p>-->
          </div>
          <div class="tab-pane fade" id="primarycontact" role="tabpanel">
            <div class="row">
              <div class="col-12" *ngIf="isProductPurchased">
                <div class="d-flex mb-2">
                  <h3 class="me-auto">Ajouter un avis</h3>
                  <div class="cursor-pointer me-2">
                    <i
                      class="bx bxs-star fs-2 {{
                        reviewStars > 0 ? 'text-warning' : 'text-secondary'
                      }}"
                      (click)="setReviewStars(1)"
                    ></i>
                    <i
                      class="bx bxs-star fs-2 {{
                        reviewStars > 1 ? 'text-warning' : 'text-secondary'
                      }}"
                      (click)="setReviewStars(2)"
                    ></i>
                    <i
                      class="bx bxs-star fs-2 {{
                        reviewStars > 2 ? 'text-warning' : 'text-secondary'
                      }}"
                      (click)="setReviewStars(3)"
                    ></i>
                    <i
                      class="bx bxs-star fs-2 {{
                        reviewStars > 3 ? 'text-warning' : 'text-secondary'
                      }}"
                      (click)="setReviewStars(4)"
                    ></i>
                    <i
                      class="bx bxs-star fs-2 {{
                        reviewStars > 4 ? 'text-warning' : 'text-secondary'
                      }}"
                      (click)="setReviewStars(5)"
                    ></i>
                  </div>
                  <button class="btn btn-primary" (click)="postReview()">
                    Publier l'avis
                  </button>
                </div>
                <textarea
                  class="form-control"
                  name="comment"
                  id="comment"
                  cols="30"
                  rows="5"
                  placeholder="Décrivez votre expérience avec ce produit"
                  [(ngModel)]="reviewComment"
                ></textarea>
              </div>
              <h2 class="mt-3">Avis</h2>
              <p *ngIf="reviews.length == 0">Aucun avis trouvé !</p>
              <div class="col-4 p-3" *ngFor="let r of reviews">
                <h6>{{ r.customerName }}</h6>
                <div class="cursor-pointer">
                  <i
                    class="bx bxs-star fs-4 {{
                      r.star > 0 ? 'text-warning' : 'text-secondary'
                    }}"
                  ></i>
                  <i
                    class="bx bxs-star fs-4 {{
                      r.star > 1 ? 'text-warning' : 'text-secondary'
                    }}"
                  ></i>
                  <i
                    class="bx bxs-star fs-4 {{
                      r.star > 2 ? 'text-warning' : 'text-secondary'
                    }}"
                  ></i>
                  <i
                    class="bx bxs-star fs-4 {{
                      r.star > 3 ? 'text-warning' : 'text-secondary'
                    }}"
                  ></i>
                  <i
                    class="bx bxs-star fs-4 {{
                      r.star > 4 ? 'text-warning' : 'text-secondary'
                    }}"
                  ></i>
                </div>
                <p>{{ r.comment }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
