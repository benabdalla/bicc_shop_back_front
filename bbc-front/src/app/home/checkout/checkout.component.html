<div class="page-content">
  <div class="page-wrapper">
    <section class="checkout-page">
      <div class="container">
        <form (submit)="placeOrder()" class="fade-in">
          <div class="row">
            <div class="col-lg-8">
              <h3 class="from-title">Confirmation de commande</h3>
              <hr />
              <div class="row mt-3 g-3">
                <div class="col-md-6">
                  <div class="form-group">
                    <input
                      type="text"
                      id="full-name"
                      name="full-name"
                      class="form-control"
                      placeholder="Nom complet"
                      [(ngModel)]="customerName"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <input
                      type="email"
                      id="emailAddress"
                      name="email"
                      class="form-control"
                      placeholder="Adresse e-mail"
                      [(ngModel)]="customerEmail"
                    />
                  </div>
                </div>

                <div class="col-lg-12">
                  <h5 class="mt-4">üìç Adresse de livraison</h5>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <select
                      #_div
                      class="form-select"
                      name="state"
                      id="state"
                      (change)="onDivisionSelect(_div.value)"
                    >
                      <option value="">üåç S√©lectionner une r√©gion</option>
                      <option
                        *ngFor="let div of divisions"
                        value="{{ div.id }}"
                      >
                        {{ div.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-group">
                    <select
                      #_dis
                      class="form-select"
                      name="city"
                      id="city"
                      (change)="onDistrictSelect(_dis.value)"
                    >
                      <option value="">üèôÔ∏è S√©lectionner une ville</option>
                      <option
                        *ngFor="let dis of selectedDistricts"
                        value="{{ dis.id }}"
                      >
                        {{ dis.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="col-md-12 d-flex align-items-center mt-4">
                  <h6 class="d-inline me-3">üöö Mode de livraison :</h6>
                  <div class="form-check form-check-inline">
                    <input
                      class="btn-check"
                      checked
                      type="radio"
                      name="ship-method"
                      id="home-delivery"
                      (click)="onShippingSelected('h')"
                    />
                    <label class="btn" for="home-delivery">
                      üè† Livraison √† domicile
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input
                      class="btn-check"
                      type="radio"
                      name="ship-method"
                      id="collection-point"
                      (click)="onShippingSelected('c')"
                    />
                    <label class="btn" for="collection-point">
                      üì¶ Point de collecte
                    </label>
                  </div>
                </div>

                <div class="mt-0 row g-3 fade-in" *ngIf="homeDelivery">
                  <div class="col-md-6">
                    <div class="form-group">
                      <input
                        type="text"
                        id="zip"
                        name="zip"
                        class="form-control"
                        placeholder="Code postal"
                        [(ngModel)]="shippingPostCode"
                      />
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <input
                        type="text"
                        id="street-name"
                        name="street-name"
                        class="form-control"
                        placeholder="Maison, rue"
                        [(ngModel)]="shippingStreet"
                      />
                    </div>
                  </div>
                </div>

                <div class="col-lg-12 fade-in" *ngIf="collectionPoint">
                  <div class="form-group mt-2">
                    <select
                      #_col
                      class="form-select"
                      name="collection"
                      id="collection"
                      (change)="onCollectionSelect(_col.value)"
                    >
                      <option value="-1">
                        üìç S√©lectionner un point de collecte
                      </option>
                      <option
                        *ngFor="let item of collectionPoints; let i = index"
                        value="{{ i }}"
                      >
                        {{ item.name.concat(", ").concat(item.address) }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="delivery-info">
                  <p class="d-inline">
                    üìÖ Votre date de livraison estim√©e est le <strong>{{ deliveryDate }}</strong>.
                    <span *ngIf="homeDelivery">
                      Vous souhaitez une date pr√©cise ?
                    </span>
                  </p>
                  <input
                    *ngIf="homeDelivery"
                    class="form-control mt-2"
                    type="date"
                    name="deliveryDate"
                    [(ngModel)]="deliveryDate"
                  />
                </div>

                <div class="col-lg-12">
                  <h5 class="mt-3">üìù Notes de commande (optionnel)</h5>
                </div>
                <div class="col-md-12">
                  <div class="form-group">
                    <textarea
                      name="order-note"
                      id="order-note"
                      class="form-control"
                      rows="5"
                      placeholder="üìã Notes concernant votre commande, ex : instructions sp√©ciales pour la livraison."
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg-4">
              <h3 class="from-title mb-25">üìä R√©sum√© de la commande</h3>
              <hr />

              <div class="package-summary mt-35 mb-25">
                <table>
                  <tbody>
                    <tr *ngFor="let item of cartItems">
                      <td>
                        <strong>{{ item.productName }}</strong>
                        <span class="text-muted">√ó {{ item.productQuantity }}</span>
                      </td>
                      <td class="text-end">
                        <strong>{{ item.subTotal.toFixed(2) }}TND</strong>
                      </td>
                    </tr>
                    <tr>
                      <td>üöö Frais de livraison</td>
                      <td class="text-end">
                        {{ shippingCharge.toFixed(2) }}TND
                      </td>
                    </tr>
            
                    <tr *ngIf="tax > 0">
                      <td>üìä Taxe (5%)</td>
                      <td class="text-end">{{ tax.toFixed(2) }}TND</td>
                    </tr>
                    <tr *ngIf="discount > 0">
                      <td>üéÅ Remise {{ discountReason }}</td>
                      <td class="text-end text-success">-{{ discount.toFixed(2) }}TND</td>
                    </tr>
                    <tr>
                      <td><strong>üí∞ Total de la commande</strong></td>
                      <td class="text-end">
                        <strong style="color: #667eea; font-size: 20px;">{{ orderTotal.toFixed(2) }}TND</strong>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="coupon-section">
                <h6 class="mt-2 mb-3">üé´ Utiliser un coupon</h6>
                <div class="row g-2">
                  <div class="col-8">
                    <div class="form-group">
                      <input
                        type="text"
                        id="holder-name"
                        name="holder-name"
                        class="form-control"
                        placeholder="Code coupon"
                        [(ngModel)]="couponCode"
                      />
                    </div>
                  </div>
                  <div class="col-4">
                    <button
                      (click)="applyCoupon()"
                      class="btn btn-outline-primary w-100"
                    >
                      Appliquer
                    </button>
                  </div>
                </div>
              </div>

              <div class="payment-section">
                <h5 class="title mt-2 mb-3">üí≥ Mode de paiement</h5>
                <div class="form-group">
                  <select
                    #_payment
                    class="form-select"
                    name="payment"
                    id="payment"
                    (change)="onPaymentMethod(_payment.value)"
                  >
                    <option value="">Choisir une option</option>
                    <option value="COD">üíµ Paiement √† la livraison</option>
                  </select>
                </div>

                <div *ngIf="cardForm" class="card-details fade-in">
                  <h6 class="mt-2 mb-3">üí≥ D√©tails de la carte</h6>
                  <div class="row g-3">
                    <div class="col-md-12">
                      <div class="form-group">
                        <input
                          type="text"
                          id="holder-name"
                          name="holder-name"
                          class="form-control"
                          placeholder="Nom du titulaire"
                          [(ngModel)]="cardHolderName"
                        />
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <input
                          type="text"
                          id="card-number"
                          name="card-number"
                          class="form-control"
                          placeholder="Num√©ro de carte"
                          [(ngModel)]="cardNumber"
                        />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <input
                          type="text"
                          id="card-cvv"
                          name="card-cvv"
                          class="form-control"
                          placeholder="CVV"
                          [(ngModel)]="cardCvv"
                        />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <input
                          type="text"
                          id="card-expiry"
                          name="card-expiry"
                          class="form-control"
                          placeholder="MM/AA"
                          [(ngModel)]="cardExpiryDate"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn btn-primary mt-3 w-100">
                üõí Valider la commande
              </button>
            </div>
          </div>
        </form>
      </div>
    </section>
  </div>
</div>
